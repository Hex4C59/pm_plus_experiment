# losses 模板说明

此目录为“损失函数（loss）”代码模板，负责组织项目中用于训练的各种任务级损失函数实现与组合器。README 只说明目录定位、接口约定与使用方式，不涉及具体实现细节或文件内容。

目的
- 将所有与损失计算相关的实现集中管理，便于复用、替换与测试。
- 约定统一的损失函数接口，降低训练/评估代码对具体实现的耦合。

建议目录组织
- losses/
  - __init__.py          # 可选：导出常用损失或注册器入口
  - base.py              # 可选：损失基类或接口定义（可包含通用公用函数）
  - <task>_loss.py       # 占位：按任务或功能划分的损失实现文件
  - factory.py           # 可选：损失构造器/注册器，根据名称创建损失实例
  - tests/               # 可选：损失单元测试（确保数值与接口正确）
  - README.md            # 本文件

接口约定（建议）
- 单个损失函数应为可调用对象或类，签名示例：
  - loss = LossClass(**cfg)
  - value = loss(predictions, targets, mask=None)
- 返回值建议为标量 Tensor（用于反向传播），同时可提供可选的字典以返回分项损失或中间信息，便于日志记录与调试。
- 支持 CPU/GPU 无缝运行并兼容混合精度（如项目使用）。

使用与扩展
- 新增损失实现时，请遵循统一签名并在 factory 或 __init__ 中注册/导出，便于训练脚本按名称加载。
- 将任务特定的超参（权重、平衡系数等）暴露在构造函数中，便于实验配置化管理。
- 避免在损失实现中耦合训练循环、优化器或日志逻辑。

测试与验证
- 为每个损失添加单元测试，覆盖输出形状、数值边界和简单数值校验（例如数值稳定性、梯度存在性）。
- 在多任务场景中，测试组合损失的加权逻辑是否按预期工作。

维护提示
- 保持实现简洁、纯粹（仅负责计算损失），将日志、保存等功能放在上层流程中。
- 文档化损失的数学定义与预期输入/输出格式，便于团队成员使用与复现。


